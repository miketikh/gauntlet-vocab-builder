#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run lint-staged for frontend
cd web && npx lint-staged

# Run Python linters for backend if Python files are staged
cd ../api
PYTHON_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep "\.py$" || true)
if [ -n "$PYTHON_FILES" ]; then
  echo "Running Python formatters and linters..."
  if [ -d "venv" ]; then
    . venv/bin/activate
  fi
  black $PYTHON_FILES
  ruff check --fix $PYTHON_FILES
  mypy $PYTHON_FILES
fi
