#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run lint-staged for frontend
cd web && npx lint-staged

# Run Python linters for backend if Python files are staged
cd ../api
PYTHON_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep "\.py$" || true)
if [ -n "$PYTHON_FILES" ]; then
  echo "Running Python formatters and linters..."
  if [ -d "venv" ]; then
    . venv/bin/activate
  fi
  python3 -m black $PYTHON_FILES || echo "black not available, skipping"
  python3 -m ruff check --fix $PYTHON_FILES || echo "ruff not available, skipping"
  # Skip mypy for now as it requires additional type stubs
  # python3 -m mypy $PYTHON_FILES || echo "mypy not available, skipping"
fi
